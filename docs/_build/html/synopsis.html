<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Synopsis &mdash; esgscan_directory 0.5.2 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="esgscan_directory 0.5.2 documentation" href="index.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="esg_mapfiles" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="esg_mapfiles"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">esgscan_directory 0.5.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="synopsis">
<span id="id1"></span><h1>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h1>
<p>The publication process of the <a class="reference external" href="http://pcmdi9.llnl.gov/">ESG-F</a> nodes requires <em>mapfiles</em>. Mapfiles are text files where each line describes a file to publish on the following format:</p>
<div class="highlight-python"><div class="highlight"><pre>dataset_ID | absolute_path | size_bytes [ | option=value ]
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ol class="last lowerroman simple">
<li>All values have to be pipe-separated.</li>
<li>The dataset identifier, the absolute path and the size (in bytes) are required.</li>
<li>Adding the file checksum and the checksum type as optional values is strongly recommended.</li>
</ol>
</div>
<p><code class="docutils literal"><span class="pre">esgscan_directory</span></code> is a flexible command-line tool allowing you to easily generate mapfiles.</p>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><strong>Directory as input</strong></dt>
<dd>You only need to specifiy the directory to recursively scan. To include several data directories in one mapfile and to publish them at once, you can use all Unix wildcards in the path or submit several paths.</dd>
<dt><strong>Multi-project</strong></dt>
<dd><code class="docutils literal"><span class="pre">time_axis</span></code> is currently provided supporting <a class="reference external" href="http://cmip-pcmdi.llnl.gov/cmip5/docs/cmip5_data_reference_syntax.pdf">CMIP5</a> and <a class="reference external" href="https://www.medcordex.eu/cordex_archive_specifications_2.2_30sept2013.pdf">CORDEX</a> <em>Data Reference Syntax</em> (DRS). Nevertheless, you can easily add a new &#8220;project&#8221; section in the configuration file to support yours. Please follow the <a class="reference external" href="https://en.wikipedia.org/wiki/INI_file">INI syntax</a>.</dd>
<dt><strong>Facets auto-detection</strong></dt>
<dd>The dataset facets will be automatically detect using the <code class="docutils literal"><span class="pre">directory_format</span></code> regular expression in the configuration file where all facet options have to be declared. This ensures an appropriated mapfile generation by preventing DRS mistakes and checking the controlled vocabulary.</dd>
<dt><strong>Multithreading</strong></dt>
<dd>To compute the checksum of a lot of large files becomes time consuming. We implement multithreading at file level. Each file is processed by a thread that writes the resulting line in the corresponding mapfile. A lock file system orders the simultaneous access to mapfiles by the threads to avoid any conflicts.</dd>
<dt><strong>Mapfile granularity control</strong></dt>
<dd>You can choose to produce one mapfile per dataset (i.e., to generate one mapfile per each version of each dataset). In this case your mapfiles automatically take the name of the dataset identifier with DRS version as suffix. Consequently, you can set your own &#8220;mapfile-granularity&#8221; and control your publications by concatenating several mapfiles.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A dataset is defined by one version of all upstream DRS tree.</p>
</div>
<dl class="docutils">
<dt><strong>Only latest version</strong></dt>
<dd>You can choose to only include the latest versions of the datasets in your mapfile. In this case, the walk through the filesystem is filtered. Only the folders pointed by a &#8220;latest&#8221; symbolic link are recursively scanned.</dd>
<dt><strong>Mapfile with DRS version</strong></dt>
<dd>You can choose to include the DRS version into each dataset ID. This is compatible with the <a class="reference external" href="http://pcmdi9.llnl.gov/">ESG-F</a> 2.0 release and leads to a full-slave behaviour of the <a class="reference external" href="https://github.com/ESGF/esg-publisher">ESG-F publisher</a>. With this mapfile syntax the <code class="docutils literal"><span class="pre">--new-version</span></code> option of the publisher command-lines is deprecated.</dd>
<dt><strong>Developer&#8217;s entry point</strong></dt>
<dd><code class="docutils literal"><span class="pre">esgscan_directory</span></code> can be imported and called in your own scripts. Just pass a dictionnary with your flags to the <code class="docutils literal"><span class="pre">run(job={})</span></code> function (see <a class="reference internal" href="autodoc.html#autodoc"><span>Code documentation</span></a>).</dd>
<dt><strong>Standalone</strong></dt>
<dd>Security policies of computing centres, that often host <a class="reference external" href="http://pcmdi9.llnl.gov/">ESG-F</a> data and datanodes, do not allow to easily access the node configuration. <code class="docutils literal"><span class="pre">esgscan_directory</span></code> is not part of <a class="reference external" href="http://pcmdi9.llnl.gov/">ESG-F</a> software stack and can be run as standalone tool outside any <a class="reference external" href="http://pcmdi9.llnl.gov/">ESG-F</a> node.</dd>
<dt><strong>Compatible with ESG-F node configuration file</strong></dt>
<dd>Each <a class="reference external" href="http://pcmdi9.llnl.gov/">ESG-F</a> node centralizes all projects definitions (DRS, facets) one INI configuration file <code class="docutils literal"><span class="pre">esg.ini</span></code> file. To ensure a right facets auto-detection, <code class="docutils literal"><span class="pre">esgscan_directory</span></code> directly works from <code class="docutils literal"><span class="pre">esg.ini</span></code>.</dd>
<dt><strong>Vocabulary checkup</strong></dt>
<dd><code class="docutils literal"><span class="pre">esgscan_directory</span></code> was accompanied by <code class="docutils literal"><span class="pre">esgscan_check_vocab</span></code>. This module allows you to easily check the facet options declared in your configuration file depending on the direcotires you want to recursively scan.</dd>
<dt><strong>Keep threads tracebacks</strong></dt>
<dd>The threads-processes do not shutdown the main process of <code class="docutils literal"><span class="pre">esgscan_directory</span></code> run. If an error occurs on a thread, the traceback of the child-process is not raised to the main process. To help you to have a fast debug, the tracebacks of each threads can be raised using the <code class="docutils literal"><span class="pre">-v/--verbose</span></code> option (see <a class="reference internal" href="usage.html#usage"><span>Usage</span></a>).</dd>
<dt><strong>Output directory</strong></dt>
<dd>An output directory can be defined to store and organized your mapfiles.</dd>
<dt><strong>Use a logfile</strong></dt>
<dd>You can initiate a logger instead of the standard output. This could be useful for automatic workflows. The logfile name is automatically defined and unique (using the the job&#8217;s name, the date and the job&#8217;s PID). You can define an output directory for your logs too.</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Synopsis</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">esg_mapfiles</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="installation.html"
                        title="next chapter">Installation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/synopsis.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="esg_mapfiles"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">esgscan_directory 0.5.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Levavasseur, G..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>