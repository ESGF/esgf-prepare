

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Generic usage &mdash; esgprep 2.9.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="esgprep 2.9.0 documentation" href="index.html"/>
        <link rel="next" title="Fetch ESGF configuration INI files" href="fetchini.html"/>
        <link rel="prev" title="Configuration" href="configuration.html"/> 

  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> esgprep
          

          
          </a>

          
            
            
              <div class="version">
                2.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generic usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#check-the-help">Check the help</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-the-version">Check the version</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debug-mode">Debug mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specify-the-project">Specify the project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#submit-a-configuration-directory">Submit a configuration directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-a-logfile">Use a logfile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-filters">Use filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-multiprocessing">Use multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exit-status">Exit status</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fetchini.html">Fetch ESGF configuration INI files</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetchtables.html">Fetch CMOR tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="drs.html">Manage local data through the DRS</a></li>
<li class="toctree-l1"><a class="reference internal" href="checkvocab.html">Check CV against configuration INI files</a></li>
<li class="toctree-l1"><a class="reference internal" href="mapfiles.html">Generate mapfile for ESGF publication</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="autodoc.html">Code documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">esgprep</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Generic usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="generic-usage">
<span id="usage"></span><h1>Generic usage<a class="headerlink" href="#generic-usage" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>All the following arguments can be safely combined and add to each of the esgprep <strong>COMMAND</strong>:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">esgfetchini</span></code></li>
<li><code class="docutils literal"><span class="pre">esgdrs</span></code></li>
<li><code class="docutils literal"><span class="pre">esgcheckvocab</span></code></li>
<li><code class="docutils literal"><span class="pre">esgmapfile</span></code></li>
</ul>
</dd>
</dl>
<div class="section" id="check-the-help">
<h2>Check the help<a class="headerlink" href="#check-the-help" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> -h
</pre></div>
</div>
</div>
<div class="section" id="check-the-version">
<h2>Check the version<a class="headerlink" href="#check-the-version" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND -v
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The program version will be the same for all the esgprep tools.</p>
</div>
</div>
<div class="section" id="debug-mode">
<h2>Debug mode<a class="headerlink" href="#debug-mode" title="Permalink to this headline">¶</a></h2>
<p>Some progress bars informs you about the processing status of the different subcommands. You can switch to a more
verbose mode displaying each step with useful additional information.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> --debug
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This debug/verbose mode is silently activated in the case of a logfile (i.e., no progress bars).</p>
</div>
</div>
<div class="section" id="specify-the-project">
<h2>Specify the project<a class="headerlink" href="#specify-the-project" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">--project</span></code> argument is used to parse the corresponding configuration INI file. It is <strong>always required</strong>
(except for <code class="docutils literal"><span class="pre">esgfetchini</span></code> and <code class="docutils literal"><span class="pre">esgfetchtables</span></code> subcommands). This argument is case-sensitive and has to
correspond to a section name of the configuration file(s).</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> --project PROJECT_ID
</pre></div>
</div>
</div>
<div class="section" id="submit-a-configuration-directory">
<h2>Submit a configuration directory<a class="headerlink" href="#submit-a-configuration-directory" title="Permalink to this headline">¶</a></h2>
<p>By default, the configuration files are fetched or read from the <code class="docutils literal"><span class="pre">$ESGINI</span></code> environment variable. If not exists,
<code class="docutils literal"><span class="pre">/esg/config/esgcet</span></code> that is the usual configuration directory on ESGF nodes is used. If you’re preparing your data
outside of an ESGF node, you can submit another directory to fetch and read the configuration files.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> -i /PATH/TO/CONFIG/
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the case of <code class="docutils literal"><span class="pre">esgfetchini</span></code> command, if you’re not on an ESGF node and <code class="docutils literal"><span class="pre">/esg/config/esgcet</span></code> doesn’t exist,
the configuration file(s) are fetched into an <code class="docutils literal"><span class="pre">ini</span></code> folder in your working directory.</p>
</div>
</div>
<div class="section" id="use-a-logfile">
<h2>Use a logfile<a class="headerlink" href="#use-a-logfile" title="Permalink to this headline">¶</a></h2>
<p>All errors and exceptions are logged into a file named <code class="docutils literal"><span class="pre">esgprep-YYYYMMDD-HHMMSS-PID.err</span></code>.
Other information are logged into a file named <code class="docutils literal"><span class="pre">esgprep-YYYYMMDD-HHMMSS-PID.log</span></code> only if <code class="docutils literal"><span class="pre">--log</span></code> is submitted.
If not, the standard output is used following the verbose mode.
By default, the logfiles are stored in a <code class="docutils literal"><span class="pre">logs</span></code> folder created in your current working directory (if not exists).
It can be changed by adding a optional logfile directory to the flag.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> -l
$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> -l /PATH/TO/LOGDIR/
</pre></div>
</div>
</div>
<div class="section" id="use-filters">
<h2>Use filters<a class="headerlink" href="#use-filters" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">esgcheckvocab</span></code> and <code class="docutils literal"><span class="pre">esgmapfile</span></code> subcommands will scan your local archive to achieve proper data
management. In such a scan, you can filter the file discovery by using a Python regular expression
(see <a class="reference external" href="https://docs.python.org/2/library/re.html">re</a> Python library).</p>
<p>The default is to walk through your local filesystem ignoring the <code class="docutils literal"><span class="pre">files</span></code> and <code class="docutils literal"><span class="pre">latest</span></code> version levels
and any hidden folders by using the following regular expression: <code class="docutils literal"><span class="pre">^.*/(files|latest|\.[\w]*).*$</span></code>. It can be change
with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> --ignore-dir PYTHON_REGEX
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">esgprep</span></code> only considers unhidden NetCDF files by default excuding the regular expression <code class="docutils literal"><span class="pre">^\..*$</span></code> and
including the following one <code class="docutils literal"><span class="pre">.*\.nc$</span></code>. It can be independently change with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> --include-file PYTHON_REGEX --exclude-file PYTHON_REGEX
</pre></div>
</div>
<p>Keep in mind that <code class="docutils literal"><span class="pre">--ignore-dir</span></code> and <code class="docutils literal"><span class="pre">--exclude-file</span></code> specifie a directory pattern <strong>NOT</strong> to be matched, while
<code class="docutils literal"><span class="pre">--include-file</span></code> specifies a filename pattern <strong>TO BE</strong> matched.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><code class="docutils literal"><span class="pre">esgfetchini</span></code> does not allow those features and <code class="docutils literal"><span class="pre">esgdrs</span></code> only works with unhidden
NetCDF files. <code class="docutils literal"><span class="pre">esgfetchtables</span></code> only supports <code class="docutils literal"><span class="pre">--include-file</span></code> and <code class="docutils literal"><span class="pre">--exclude-file</span></code> flags.</p>
</div>
</div>
<div class="section" id="use-multiprocessing">
<h2>Use multiprocessing<a class="headerlink" href="#use-multiprocessing" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">esgprep</span></code> uses a multiprocessing. This is useful to process a large amount of data, especially in the case
of <code class="docutils literal"><span class="pre">drs</span></code> and <code class="docutils literal"><span class="pre">mapfile</span></code> subcommands with file checksum computation. Set the number of maximal processes to
simultaneously treat several files. One process seems sequential processing. Set it to -1 to use all available
CPU processes (as returned by <code class="docutils literal"><span class="pre">multiprocessing.cpu_count()</span></code>). Default is set to 4 processes.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$&gt; COMMAND <span class="o">[</span>SUBCOMMAND<span class="o">]</span> --max-processes <span class="m">4</span>
</pre></div>
</div>
</div>
<div class="section" id="exit-status">
<h2>Exit status<a class="headerlink" href="#exit-status" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><dl class="first docutils">
<dt>Status = 99</dt>
<dd>Argument parsing error.</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fetchini.html" class="btn btn-neutral float-right" title="Fetch ESGF configuration INI files" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configuration.html" class="btn btn-neutral" title="Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Levavasseur, G..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.9.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>