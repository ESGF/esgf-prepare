

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Code documentation &mdash; esgprep 2.5.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="esgprep 2.5.2 documentation" href="index.html"/>
        <link rel="prev" title="Changelog" href="log.html"/> 

  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> esgprep
          

          
          </a>

          
            
            
              <div class="version">
                2.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="synopsis.html">Synopsis</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage and tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-esgprep.esgprep">esgprep</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-esgprep.fetchini.main">fetch-ini</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-esgprep.drs.main">drs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-esgprep.checkvocab.main">check-vocab</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-esgprep.mapfile.main">mapfile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-esgprep.utils.parser">utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">esgprep</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Code documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="sources/autodoc.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="code-documentation">
<span id="autodoc"></span><h1>Code documentation<a class="headerlink" href="#code-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-esgprep.esgprep">
<span id="esgprep"></span><h2>esgprep<a class="headerlink" href="#module-esgprep.esgprep" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-esgprep"></span><p><em>Module author: Guillaume Levavasseur &lt;<a class="reference external" href="mailto:glipsl&#37;&#52;&#48;ipsl&#46;jussieu&#46;fr">glipsl<span>&#64;</span>ipsl<span>&#46;</span>jussieu<span>&#46;</span>fr</a>&gt;</em></p>
<dl class="function">
<dt id="esgprep.esgprep.get_args">
<code class="descclassname">esgprep.esgprep.</code><code class="descname">get_args</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/esgprep.html#get_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.esgprep.get_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns parsed command-line arguments. See <code class="docutils literal"><span class="pre">esgprep</span> <span class="pre">-h</span></code> for full description.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The corresponding <code class="docutils literal"><span class="pre">argparse</span></code> Namespace</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><em>ArgumentParser</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="module-esgprep.fetchini.main">
<span id="fetch-ini"></span><h3>fetch-ini<a class="headerlink" href="#module-esgprep.fetchini.main" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Fetches ESGF configuration files from GitHub repository.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="esgprep.fetchini.main.build_http">
<code class="descclassname">esgprep.fetchini.main.</code><code class="descname">build_http</code><span class="sig-paren">(</span><em>project</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/fetchini/main.html#build_http"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.fetchini.main.build_http" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the HTTP URL to get esg.&lt;project&gt;.ini file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>project</strong> (<em>str</em>) &#8211; The lower-cased project name</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The HTTP URL to request</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>str</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.fetchini.main.query_yes_no">
<code class="descclassname">esgprep.fetchini.main.</code><code class="descname">query_yes_no</code><span class="sig-paren">(</span><em>question</em>, <em>default='no'</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/fetchini/main.html#query_yes_no"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.fetchini.main.query_yes_no" title="Permalink to this definition">¶</a></dt>
<dd><p>Asks a yes/no question via raw_input() and return their answer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>question</strong> (<em>str</em>) &#8211; The question string that is presented to the user</li>
<li><strong>default</strong> (<em>str</em>) &#8211; The default answer is the string if the user just hits the carriage return.
If None an answer is required.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The answer True or False</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>boolean</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.fetchini.main.get_github_files_list">
<code class="descclassname">esgprep.fetchini.main.</code><code class="descname">get_github_files_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/fetchini/main.html#get_github_files_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.fetchini.main.get_github_files_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of esg.*.ini files from the GitHub repository.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The filenames</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><em>list</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.fetchini.main.fetch">
<code class="descclassname">esgprep.fetchini.main.</code><code class="descname">fetch</code><span class="sig-paren">(</span><em>url</em>, <em>outdir</em>, <em>project</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/fetchini/main.html#fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.fetchini.main.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads an esg.&lt;project&gt;.ini file from GitHub URL to local file system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> (<em>str</em>) &#8211; The URL to fetch</li>
<li><strong>outdir</strong> &#8211; The output directory to write</li>
<li><strong>project</strong> &#8211; The lower-cased project name</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.fetchini.main.main">
<code class="descclassname">esgprep.fetchini.main.</code><code class="descname">main</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/fetchini/main.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.fetchini.main.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main process that:</p>
<blockquote>
<div><ul class="simple">
<li>Checks if output directory exists,</li>
<li>Checks if configuration already exists in output directory,</li>
<li>Asks confirmation if necessary,</li>
<li>Tests the corresponding GitHub URL,</li>
<li>Gets the GitHub URL,</li>
<li>Writes response into INI file.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>ArgumentParser</em>) &#8211; Parsed command-line arguments</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-esgprep.fetchini.exceptions"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Custom exceptions used in this module.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-esgprep.drs.main">
<span id="drs"></span><h3>drs<a class="headerlink" href="#module-esgprep.drs.main" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Manages the filesystem tree according to the project the Data Reference Syntax and versioning.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="esgprep.drs.main.main">
<code class="descclassname">esgprep.drs.main.</code><code class="descname">main</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/drs/main.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.drs.main.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main process that:</p>
<blockquote>
<div><ul class="simple">
<li>Instantiates processing context</li>
<li>Parses the configuration files options and values,</li>
<li>Deduces facets and values from directories,</li>
<li>Compares the values of each facet between both,</li>
<li>Print or log the checking.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>ArgumentParser</em>) &#8211; Parsed command-line arguments</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-esgprep.drs.exceptions"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Custom exceptions used in this module.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-esgprep.checkvocab.main">
<span id="check-vocab"></span><h3>check-vocab<a class="headerlink" href="#module-esgprep.checkvocab.main" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Checks DRS vocabulary against configuration files.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="esgprep.checkvocab.main.ProcessingContext">
<em class="property">class </em><code class="descclassname">esgprep.checkvocab.main.</code><code class="descname">ProcessingContext</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/checkvocab/main.html#ProcessingContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.checkvocab.main.ProcessingContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates the following processing context/information for main process:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="16%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>self</em>.directory</td>
<td><em>list</em></td>
<td>Paths to scan</td>
</tr>
<tr class="row-odd"><td><em>self</em>.project</td>
<td><em>str</em></td>
<td>Project</td>
</tr>
<tr class="row-even"><td><em>self</em>.cfg</td>
<td><em>callable</em></td>
<td>Configuration file parser</td>
</tr>
<tr class="row-odd"><td><em>self</em>.project_section</td>
<td><em>str</em></td>
<td>Project section name in configuration file</td>
</tr>
<tr class="row-even"><td><em>self</em>.pattern</td>
<td><em>re object</em></td>
<td>DRS regex pattern without version</td>
</tr>
<tr class="row-odd"><td><em>self</em>.facets</td>
<td><em>list</em></td>
<td>List of the DRS facets</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>ArgumentParser</em>) &#8211; Parsed command-line arguments</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The processing context</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>ProcessingContext</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.checkvocab.main.get_dsets_from_tree">
<code class="descclassname">esgprep.checkvocab.main.</code><code class="descname">get_dsets_from_tree</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/checkvocab/main.html#get_dsets_from_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.checkvocab.main.get_dsets_from_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields datasets to process. Only the &#8220;dataset part&#8221; of the DRS tree is returned
(i.e., from &#8220;root&#8221; to before the &#8220;version&#8221; facet).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ctx</strong> (<a class="reference internal" href="#esgprep.checkvocab.main.ProcessingContext" title="esgprep.checkvocab.main.ProcessingContext"><em>esgprep.checkvocab.main.ProcessingContext</em></a>) &#8211; The processing context</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The dataset as a part of the DRS tree</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>iter</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.checkvocab.main.get_facet_values_from_tree">
<code class="descclassname">esgprep.checkvocab.main.</code><code class="descname">get_facet_values_from_tree</code><span class="sig-paren">(</span><em>ctx</em>, <em>dsets</em>, <em>facets</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/checkvocab/main.html#get_facet_values_from_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.checkvocab.main.get_facet_values_from_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all used values of each facet from the DRS tree, according to the supplied directories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ctx</strong> (<a class="reference internal" href="#esgprep.checkvocab.main.ProcessingContext" title="esgprep.checkvocab.main.ProcessingContext"><em>esgprep.checkvocab.main.ProcessingContext</em></a>) &#8211; The processing context</li>
<li><strong>dsets</strong> (<em>iter</em>) &#8211; The dataset part of the DRS tree</li>
<li><strong>facets</strong> (<em>list</em>) &#8211; The facets list</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The declared values of each facet</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>dict</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.checkvocab.main.get_facet_values_from_config">
<code class="descclassname">esgprep.checkvocab.main.</code><code class="descname">get_facet_values_from_config</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facets</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/checkvocab/main.html#get_facet_values_from_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.checkvocab.main.get_facet_values_from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all declared values of each facet from the configuration file, according to the project section.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cfg</strong> (<em>RawConfigParser</em>) &#8211; The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)</li>
<li><strong>section</strong> (<em>str</em>) &#8211; The section name to parse</li>
<li><strong>facets</strong> (<em>set</em>) &#8211; The set of facets to check</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The declared values of each facet</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>dict</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.checkvocab.main.compare_values">
<code class="descclassname">esgprep.checkvocab.main.</code><code class="descname">compare_values</code><span class="sig-paren">(</span><em>facets</em>, <em>used_values</em>, <em>declared_values</em>, <em>verbosity=False</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/checkvocab/main.html#compare_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.checkvocab.main.compare_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares used values from DRS tree with all declared values in configuration file for each facet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>facets</strong> (<em>list</em>) &#8211; The facets list</li>
<li><strong>used_values</strong> (<em>dict</em>) &#8211; Dictionary of sets of used values from DRS tree</li>
<li><strong>declared_values</strong> (<em>dict</em>) &#8211; Dictionary of sets of  declared values from the configuration file</li>
<li><strong>verbosity</strong> (<em>boolean</em>) &#8211; Display declared/undeclared and used/unused values if True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if undeclared values in configuration file are used in DRS tree</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>boolean</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.checkvocab.main.main">
<code class="descclassname">esgprep.checkvocab.main.</code><code class="descname">main</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/checkvocab/main.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.checkvocab.main.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main process that:</p>
<blockquote>
<div><ul class="simple">
<li>Instantiates processing context</li>
<li>Parses the configuration files options and values,</li>
<li>Deduces facets and values from directories,</li>
<li>Compares the values of each facet between both,</li>
<li>Print or log the checking.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>ArgumentParser</em>) &#8211; Parsed command-line arguments</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-esgprep.checkvocab.exceptions"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Custom exceptions used in this module.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-esgprep.mapfile.main">
<span id="mapfile"></span><h3>mapfile<a class="headerlink" href="#module-esgprep.mapfile.main" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Generates ESGF mapfiles upon a local ESGF node or not.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="esgprep.mapfile.main.ProcessingContext">
<em class="property">class </em><code class="descclassname">esgprep.mapfile.main.</code><code class="descname">ProcessingContext</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#ProcessingContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.ProcessingContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates the following processing context/information for main process:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="16%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>self</em>.directory</td>
<td><em>list</em></td>
<td>Paths to scan</td>
</tr>
<tr class="row-odd"><td><em>self</em>.outmap</td>
<td><em>str</em></td>
<td>Mapfile name/pattern using tokens</td>
</tr>
<tr class="row-even"><td><em>self</em>.latest</td>
<td><em>boolean</em></td>
<td>True to follow latest symlink</td>
</tr>
<tr class="row-odd"><td><em>self</em>.outdir</td>
<td><em>str</em></td>
<td>Output directory</td>
</tr>
<tr class="row-even"><td><em>self</em>.notes_url</td>
<td><em>str</em></td>
<td>Dataset technical notes URL</td>
</tr>
<tr class="row-odd"><td><em>self</em>.notes_title</td>
<td><em>str</em></td>
<td>Dataset technical notes title</td>
</tr>
<tr class="row-even"><td><em>self</em>.verbose</td>
<td><em>boolean</em></td>
<td>True if verbose mode</td>
</tr>
<tr class="row-odd"><td><em>self</em>.all</td>
<td><em>boolean</em></td>
<td>True to scan all versions</td>
</tr>
<tr class="row-even"><td><em>self</em>.version</td>
<td><em>str</em></td>
<td>Version to scan</td>
</tr>
<tr class="row-odd"><td><em>self</em>.filter</td>
<td><em>re object</em></td>
<td>File filter as regex pattern</td>
</tr>
<tr class="row-even"><td><em>self</em>.no_version</td>
<td><em>boolean</em></td>
<td>True to not include version in dataset ID</td>
</tr>
<tr class="row-odd"><td><em>self</em>.project</td>
<td><em>str</em></td>
<td>Project</td>
</tr>
<tr class="row-even"><td><em>self</em>.project_section</td>
<td><em>str</em></td>
<td>Project section name in configuration file</td>
</tr>
<tr class="row-odd"><td><em>self</em>.dataset</td>
<td><em>str</em></td>
<td>Dataset ID name</td>
</tr>
<tr class="row-even"><td><em>self</em>.checksum_client</td>
<td><em>str</em></td>
<td>Checksum client as shell command-line to use</td>
</tr>
<tr class="row-odd"><td><em>self</em>.checksum_type</td>
<td><em>str</em></td>
<td>Checksum type</td>
</tr>
<tr class="row-even"><td><em>self</em>.threads</td>
<td><em>int</em></td>
<td>Maximum threads number</td>
</tr>
<tr class="row-odd"><td><em>self</em>.cfg</td>
<td><em>callable</em></td>
<td>Configuration file parser</td>
</tr>
<tr class="row-even"><td><em>self</em>.pattern</td>
<td><em>re object</em></td>
<td>DRS regex pattern</td>
</tr>
<tr class="row-odd"><td><em>self</em>.facets</td>
<td><em>list</em></td>
<td>List of the DRS facets</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>ArgumentParser</em>) &#8211; Parsed command-line arguments</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The processing context</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>ProcessingContext</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.yield_inputs">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">yield_inputs</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#yield_inputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.yield_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields all files to process within tuples with the processing context. The file walking
through the DRS tree follows the latest version of each dataset. This behavior is modified
using:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">--all-versions</span></code> flag, to pick up all versions,</li>
<li><code class="docutils literal"><span class="pre">--version</span> <span class="pre">&lt;version_number&gt;</span></code> argument, to pick up a specified version,</li>
<li><code class="docutils literal"><span class="pre">--latest-symlink</span></code> flag, to pick up the version pointed by the latest symlink (if exists).</li>
</ul>
</div></blockquote>
<p>If the supplied directory to scan specifies the version into its path, only this version is
picked up as with <code class="docutils literal"><span class="pre">--version</span></code> argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Attach the processing context to a file to process as an iterator of tuples</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>iter</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.wrapper">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">wrapper</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Transparent wrapper for pool map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inputs</strong> (<em>tuple</em>) &#8211; A tuple with the file path and the processing context</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The <a class="reference internal" href="#esgprep.mapfile.main.process" title="esgprep.mapfile.main.process"><code class="xref py py-func docutils literal"><span class="pre">process()</span></code></a> call</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>callable</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.counted">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">counted</code><span class="sig-paren">(</span><em>fct</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#counted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.counted" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator used to count all file process calls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fct</strong> (<em>callable</em>) &#8211; The function to monitor</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A wrapped function with a <code class="docutils literal"><span class="pre">.called</span></code> attribute</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>callable</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.get_output_mapfile">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">get_output_mapfile</code><span class="sig-paren">(</span><em>attributes</em>, <em>dataset_id</em>, <em>dataset_version</em>, <em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#get_output_mapfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.get_output_mapfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the mapfile full path depending on:</p>
<blockquote>
<div><ul class="simple">
<li>the &#8211;mapfile name using tokens,</li>
<li>the &#8211;outdir output directory.</li>
</ul>
</div></blockquote>
<p>The output directory can be deduced from file attributes in the case of a mapfile DRS.
The <code class="docutils literal"><span class="pre">mapfile_drs</span></code> defined into esg.&lt;project&gt;.ini file can joined or substituted to output directory (default
is the current working directory).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>attributes</strong> (<em>dict</em>) &#8211; The facets values deduces from file full path</li>
<li><strong>dataset_id</strong> (<em>str</em>) &#8211; The corresponding dataset id</li>
<li><strong>dataset_version</strong> (<em>str</em>) &#8211; The corresponding dataset version</li>
<li><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The mapfile full path</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>str</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.generate_mapfile_entry">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">generate_mapfile_entry</code><span class="sig-paren">(</span><em>dataset_id</em>, <em>dataset_version</em>, <em>ffp</em>, <em>size</em>, <em>mtime</em>, <em>csum</em>, <em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#generate_mapfile_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.generate_mapfile_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the mapfile entry corresponding to a processed file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dataset_id</strong> (<em>str</em>) &#8211; The corresponding dataset id</li>
<li><strong>dataset_version</strong> (<em>str</em>) &#8211; The corresponding dataset version</li>
<li><strong>ffp</strong> (<em>str</em>) &#8211; The file full path</li>
<li><strong>size</strong> (<em>str</em>) &#8211; The file size</li>
<li><strong>mtime</strong> (<em>str</em>) &#8211; The last modification time</li>
<li><strong>csum</strong> (<em>str</em>) &#8211; The file checksum</li>
<li><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The mapfile line/entry</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>str</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.insert_mapfile_entry">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">insert_mapfile_entry</code><span class="sig-paren">(</span><em>outfile</em>, <em>entry</em>, <em>ffp</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#insert_mapfile_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.insert_mapfile_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a mapfile entry using the <code class="docutils literal"><span class="pre">with</span></code> statement dealing with multiple threads.
It generates a lockfile to avoid that several threads write on the same file at the same time.
A LockFile is acquired and released after writing. Acquiring LockFile is timeouted if it&#8217;s locked by other thread.
Each process adds one line to the appropriate mapfile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>outfile</strong> (<em>str</em>) &#8211; The output mapfile full path</li>
<li><strong>entry</strong> (<em>str</em>) &#8211; The mapfile entry to write</li>
<li><strong>ffp</strong> (<em>str</em>) &#8211; The file full path</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.process">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">process</code><span class="sig-paren">(</span><em>ffp</em>, <em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.process" title="Permalink to this definition">¶</a></dt>
<dd><p>File process that:</p>
<blockquote>
<div><ul class="simple">
<li>Builds dataset ID,</li>
<li>Retrieves file size,</li>
<li>Does checksums,</li>
<li>Deduces mapfile name,</li>
<li>Makes output directory if not already exists,</li>
<li>Writes the corresponding line into it.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ffp</strong> (<em>str</em>) &#8211; The file full path</li>
<li><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The output file full path</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>str</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.mapfile.main.main">
<code class="descclassname">esgprep.mapfile.main.</code><code class="descname">main</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/main.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.main.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main process that:</p>
<blockquote>
<div><ul class="simple">
<li>Instantiates processing context,</li>
<li>Creates mapfiles output directory if necessary,</li>
<li>Instantiates threads pools,</li>
<li>Copies mapfile(s) to the output directory,</li>
<li>Removes the temporary directory and its content,</li>
<li>Implements exit status values.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> (<em>ArgumentParser</em>) &#8211; Parsed command-line arguments</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-esgprep.mapfile.handler"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Class to handle files for mapfile generation.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="esgprep.mapfile.handler.File">
<em class="property">class </em><code class="descclassname">esgprep.mapfile.handler.</code><code class="descname">File</code><span class="sig-paren">(</span><em>ffp</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/handler.html#File"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.handler.File" title="Permalink to this definition">¶</a></dt>
<dd><p>Handler providing methods to deal with file processing.</p>
<dl class="method">
<dt id="esgprep.mapfile.handler.File.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/handler.html#File.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.handler.File.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the attribute value corresponding to the key.
The submitted key can refer to <code class="docutils literal"><span class="pre">File.key</span></code> or <code class="docutils literal"><span class="pre">File.attributes[key]</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) &#8211; The key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The corresponding value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>str</em> or <em>list</em> or <em>dict</em> depending on the key</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="esgprep.mapfile.handler.File.load_attributes">
<code class="descname">load_attributes</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/handler.html#File.load_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.handler.File.load_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>The DRS attributes are deduced from the file full path using
the directory_format regex pattern. The project facet is added in any case with lower case.</p>
<blockquote>
<div><ul class="simple">
<li>Matches file full path with corresponding project pattern to get DRS attributes values</li>
<li>attributes.keys() are facet names</li>
<li>attributes[facet] is the facet values.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><strong>Error</strong> &#8211; If the file full path does not match the <code class="docutils literal"><span class="pre">directory_format</span></code> pattern/regex</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="esgprep.mapfile.handler.File.get_dataset_id">
<code class="descname">get_dataset_id</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/handler.html#File.get_dataset_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.handler.File.get_dataset_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the dataset identifier. If the dataset name is not specified (i.e., &#8211;dataset flag is None), it:</p>
<blockquote>
<div><ul class="simple">
<li>Checks each value which the facet is found in dataset_id AND attributes keys,</li>
<li>Gets missing attributes from the maptables in the esg.&lt;project&gt;.ini,</li>
<li>Builds the dataset identifier from the attributes.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The dataset identifier</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>str</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="esgprep.mapfile.handler.File.get_dataset_version">
<code class="descname">get_dataset_version</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/handler.html#File.get_dataset_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.handler.File.get_dataset_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the dataset version. If the version facet cannot be deduced from full path
(e.g., with &#8211;latest-symlink flag), it follows the symlink to complete the DRS attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ctx</strong> (<a class="reference internal" href="#esgprep.mapfile.main.ProcessingContext" title="esgprep.mapfile.main.ProcessingContext"><em>esgprep.mapfile.main.ProcessingContext</em></a>) &#8211; The processing context</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The dataset version</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>str</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="esgprep.mapfile.handler.File.checksum">
<code class="descname">checksum</code><span class="sig-paren">(</span><em>checksum_type</em>, <em>checksum_client</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/handler.html#File.checksum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.handler.File.checksum" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the checksum by the Shell avoiding Python memory limits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>checksum_client</strong> (<em>str</em>) &#8211; Shell command line for checksum</li>
<li><strong>checksum_type</strong> (<em>str</em>) &#8211; Checksum type</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The checksum</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><em>str</em></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>Error</strong> &#8211; If the checksum fails</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-esgprep.mapfile.exceptions"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Custom exceptions used in this module.</td>
</tr>
</tbody>
</table>
<dl class="exception">
<dt id="esgprep.mapfile.exceptions.KeyNotFound">
<em class="property">exception </em><code class="descclassname">esgprep.mapfile.exceptions.</code><code class="descname">KeyNotFound</code><span class="sig-paren">(</span><em>key</em>, <em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/exceptions.html#KeyNotFound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.exceptions.KeyNotFound" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a class key is not found.
Print list of available keys if submitted.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.mapfile.exceptions.ChecksumFail">
<em class="property">exception </em><code class="descclassname">esgprep.mapfile.exceptions.</code><code class="descname">ChecksumFail</code><span class="sig-paren">(</span><em>path</em>, <em>checksum_type=None</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/mapfile/exceptions.html#ChecksumFail"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.mapfile.exceptions.ChecksumFail" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a checksum fails.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-esgprep.utils.parser">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-esgprep.utils.parser" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Methods used to parse ESGF ini files.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="esgprep.utils.parser.CfgParser">
<em class="property">class </em><code class="descclassname">esgprep.utils.parser.</code><code class="descname">CfgParser</code><a class="reference internal" href="modules/esgprep/utils/parser.html#CfgParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.CfgParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom ConfigParser class</p>
<dl class="method">
<dt id="esgprep.utils.parser.CfgParser.options">
<code class="descname">options</code><span class="sig-paren">(</span><em>section</em>, <em>defaults=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#CfgParser.options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.CfgParser.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Can get options() with/without defaults.</p>
</dd></dl>

<dl class="method">
<dt id="esgprep.utils.parser.CfgParser.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filenames</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#CfgParser.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.CfgParser.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse a filename or a list of filenames, and records there paths.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.config_parse">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">config_parse</code><span class="sig-paren">(</span><em>path</em>, <em>section</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#config_parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.config_parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the configuration files if exist.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em>) &#8211; The absolute or relative path of the configuration file directory</li>
<li><strong>section</strong> (<em>str</em>) &#8211; The project section</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The configuration file parser</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><em>ConfigParser</em></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>Error</strong> &#8211; If no configuration file exists</li>
<li><strong>Error</strong> &#8211; If the configuration file parsing fails</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.translate_directory_format">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">translate_directory_format</code><span class="sig-paren">(</span><em>cfg</em>, <em>project_section</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#translate_directory_format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.translate_directory_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of regular expression filters associated with the <code class="docutils literal"><span class="pre">directory_format</span></code> option
in the configuration file. This can be passed to the Python <code class="docutils literal"><span class="pre">re</span></code> methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cfg</strong> (<em>RawConfigParser</em>) &#8211; The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)</li>
<li><strong>project_section</strong> (<em>str</em>) &#8211; The project section name to parse</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The corresponding <code class="docutils literal"><span class="pre">re</span></code> pattern</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.split_line">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">split_line</code><span class="sig-paren">(</span><em>line</em>, <em>sep='|'</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#split_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.split_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a line into fields removing trailing and leading characters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>line</strong> (<em>str</em>) &#8211; String line to split</li>
<li><strong>sep</strong> (<em>str</em>) &#8211; Separator character</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list of string fields</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.build_line">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">build_line</code><span class="sig-paren">(</span><em>fields</em>, <em>sep=' | '</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#build_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.build_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a line from fields adding trailing and leading characters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fields</strong> (<em>tuple</em>) &#8211; Tuple of ordered fields</li>
<li><strong>sep</strong> (<em>str</em>) &#8211; Separator character</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A string fields</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.split_record">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">split_record</code><span class="sig-paren">(</span><em>option</em>, <em>sep='|'</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#split_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.split_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a multi-line record in a configuration file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>option</strong> (<em>str</em>) &#8211; Option in the configuration file.</li>
<li><strong>sep</strong> (<em>str</em>) &#8211; Separator character.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A list of the form [[field1A, field2A, ...], [field1B, field2B, ...]]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.split_map_header">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">split_map_header</code><span class="sig-paren">(</span><em>header</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#split_map_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.split_map_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Split header of a multi-line map in a configuration file.
A map header defines the mapping between two sets of facets id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>header</strong> (<em>str</em>) &#8211; Header line of multi-line map</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">&#8216;from&#8217; and &#8216;to&#8217; tuples representing the keys for the mapping</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.split_map">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">split_map</code><span class="sig-paren">(</span><em>option</em>, <em>sep='|'</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#split_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.split_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a multi-line map in a configuration file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>option</strong> (<em>str</em>) &#8211; Option in the configuration file</li>
<li><strong>sep</strong> (<em>str</em>) &#8211; Separator character</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dictionary mapping the &#8216;from&#8217; tuples to the &#8216;to&#8217; tuples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.check_facet">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">check_facet</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>attributes</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#check_facet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.check_facet" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks a facet value against the corresponding options. Each attribute or facet is auto-detected
using the DRS pattern (regex) and compared to its corresponding options declared into the configuration file, if
exists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cfg</strong> (<em>RawConfigParser</em>) &#8211; The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)</li>
<li><strong>section</strong> (<em>str</em>) &#8211; The section name to parse</li>
<li><strong>attributes</strong> (<em>dict</em>) &#8211; A dictionary of {facet: value} to check</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>Error</strong> &#8211; If the attribute value is missing in the corresponding options list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_facet_options">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_facet_options</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facet</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_facet_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_facet_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of facet options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cfg</strong> (<em>RawConfigParser</em>) &#8211; The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)</li>
<li><strong>section</strong> (<em>str</em>) &#8211; The section name to parse</li>
<li><strong>facet</strong> (<em>str</em>) &#8211; The facet to get available values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The facet options</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><em>list</em></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>Error</strong> &#8211; If the option list or maptable is missing</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_options_from_list">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_options_from_list</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facet</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_options_from_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_options_from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of facet options from options list.
:param RawConfigParser cfg: The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)
:param str section: The section name to parse
:param str facet: The facet to get available values
:returns: The facet options
:rtype: <em>list</em>
:raises Error: If the experiment list is misdeclared</p>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_options_from_map">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_options_from_map</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facet</em>, <em>in_sources=False</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_options_from_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_options_from_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of facet options from maptable.
:param RawConfigParser cfg: The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)
:param str section: The section name to parse
:param str facet: The facet to get available values
:param boolean in_sources: True if facet is in &#8220;source keys&#8221; (default is False)
:returns: The facet options
:rtype: <em>list</em>
:raises Error: If the facet key is not in the source/destination keys of the maptable</p>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_options_from_pattern">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_options_from_pattern</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facet</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_options_from_pattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_options_from_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all <code class="docutils literal"><span class="pre">facet_patterns</span></code> attributes declared into the project section.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cfg</strong> (<em>RawConfigParser</em>) &#8211; The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)</li>
<li><strong>section</strong> (<em>str</em>) &#8211; The section name to parse</li>
<li><strong>facet</strong> (<em>str</em>) &#8211; The facet to get available values</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The facet regex</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><em>re.RegexObject</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_option_from_map">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_option_from_map</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facet</em>, <em>attributes</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_option_from_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_option_from_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the corresponding facet option from maptable.
:param RawConfigParser cfg: The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)
:param str section: The section name to parse
:param str facet: The facet to get the value
:param dict attributes: A dictionary of {facet: value} to input the maptable
:returns: The facet options
:rtype: <em>list</em>
:raises Error: If the facet key is not in the destination keys of the maptable</p>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_options_from_patterns">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_options_from_patterns</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_options_from_patterns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_options_from_patterns" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all <code class="docutils literal"><span class="pre">facet_patterns</span></code> attributes declared into the project section.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cfg</strong> (<em>RawConfigParser</em>) &#8211; The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)</li>
<li><strong>section</strong> (<em>str</em>) &#8211; The section name to parse</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dictionary of {facet: pattern}</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_default_value">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_default_value</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em>, <em>facet</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_default_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_default_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of facet options from options list.
:param RawConfigParser cfg: The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)
:param str section: The section name to parse
:param str facet: The facet to get default value
:returns: The facet options
:rtype: <em>list</em>
:raises Error: If the experiment list is misdeclared</p>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_maps">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_maps</code><span class="sig-paren">(</span><em>cfg</em>, <em>section</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of maptables.
:param RawConfigParser cfg: The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)
:param str section: The section name to parse
:returns: The maptables list
:rtype: <em>list</em>
:raises Error: If the &#8220;maps&#8221; options is missing list is misdeclared</p>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.parser.get_project_options">
<code class="descclassname">esgprep.utils.parser.</code><code class="descname">get_project_options</code><span class="sig-paren">(</span><em>cfg</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/parser.html#get_project_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.parser.get_project_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of facet options from options list.
:param RawConfigParser cfg: The configuration file parser (as a <code class="xref py py-func docutils literal"><span class="pre">ConfigParser.RawConfigParser()</span></code> class instance)
:returns: The project options
:rtype: <em>tuple</em>
:raises Error: If the project list is misdeclared</p>
</dd></dl>

<span class="target" id="module-esgprep.utils.utils"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Useful functions to use with this package.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="esgprep.utils.utils.MultilineFormatter">
<em class="property">class </em><code class="descclassname">esgprep.utils.utils.</code><code class="descname">MultilineFormatter</code><span class="sig-paren">(</span><em>prog</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/utils.html#MultilineFormatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.utils.MultilineFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom formatter class for argument parser to use with the Python
<a class="reference external" href="https://docs.python.org/2/library/argparse.html">argparse</a> module.</p>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.utils.init_logging">
<code class="descclassname">esgprep.utils.utils.</code><code class="descname">init_logging</code><span class="sig-paren">(</span><em>logdir</em>, <em>level='INFO'</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/utils.html#init_logging"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.utils.init_logging" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiates the logging configuration (output, message formatting).
In the case of a logfile, the logfile name is unique and formatted as follows:
<code class="docutils literal"><span class="pre">name-YYYYMMDD-HHMMSS-JOBID.log</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>logdir</strong> (<em>str</em>) &#8211; The relative or absolute logfile directory. If <code class="docutils literal"><span class="pre">None</span></code> the standard output is used.</li>
<li><strong>level</strong> (<em>str</em>) &#8211; The log level.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.utils.directory_checker">
<code class="descclassname">esgprep.utils.utils.</code><code class="descname">directory_checker</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/utils.html#directory_checker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.utils.directory_checker" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the supplied directory exists. The path is normalized without trailing slash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<em>str</em>) &#8211; The path list to check</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The same path list</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><em>str</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><strong>Error</strong> &#8211; If one of the directory does not exist</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.utils.version_checker">
<code class="descclassname">esgprep.utils.utils.</code><code class="descname">version_checker</code><span class="sig-paren">(</span><em>version</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/utils.html#version_checker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.utils.version_checker" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the version format from command-line.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The version if allowed</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><em>str</em></td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>Error</strong> &#8211; If invalid version format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="esgprep.utils.utils.walk">
<code class="descclassname">esgprep.utils.utils.</code><code class="descname">walk</code><span class="sig-paren">(</span><em>root</em>, <em>downstream=True</em>, <em>followlinks=False</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/utils.html#walk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.utils.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper from <code class="docutils literal"><span class="pre">os.walk</span></code> able to handle &#8220;downstream&#8221; and &#8220;upstream&#8221; tree parsing.
If &#8220;down&#8221; argument is True calls usual <code class="docutils literal"><span class="pre">os.walk</span></code>.
:param string root: The directory to start walking
:param boolean downstream: Walking the downstream tree if True
:param boolean followlinks: If True to visit directories pointed to by symlinks (only if down is True)
:returns: The current directory, its sub-directories and files list as a generator of tuple.
:rtype: <em>iter</em>
:raises Error: If the tree walking fails</p>
</dd></dl>

<span class="target" id="module-esgprep.utils.exceptions"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">Unix</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Custom exceptions used in this package.</td>
</tr>
</tbody>
</table>
<dl class="exception">
<dt id="esgprep.utils.exceptions.EmptyConfigFile">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">EmptyConfigFile</code><span class="sig-paren">(</span><em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#EmptyConfigFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.EmptyConfigFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when configuration file is empty.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoConfigFile">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoConfigFile</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoConfigFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoConfigFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when no configuration file found.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoConfigSection">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoConfigSection</code><span class="sig-paren">(</span><em>section</em>, <em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoConfigSection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoConfigSection" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when no corresponding section found in configuration file.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoConfigOption">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoConfigOption</code><span class="sig-paren">(</span><em>option</em>, <em>section</em>, <em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoConfigOption"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoConfigOption" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when no corresponding option found in a section of the configuration file.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoConfigOptions">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoConfigOptions</code><span class="sig-paren">(</span><em>facet</em>, <em>section</em>, <em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoConfigOptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoConfigOptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when no corresponding options type found in a section of the configuration file.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoConfigValue">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoConfigValue</code><span class="sig-paren">(</span><em>value</em>, <em>option</em>, <em>section</em>, <em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoConfigValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoConfigValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when no corresponding value found in option of a section from the configuration file.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoConfigVariable">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoConfigVariable</code><span class="sig-paren">(</span><em>option</em>, <em>directory_format</em>, <em>section</em>, <em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoConfigVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoConfigVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a <code class="docutils literal"><span class="pre">%(facet)s</span></code> pattern is missing into <code class="docutils literal"><span class="pre">directory_format</span></code> regex.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.MisdeclaredOption">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">MisdeclaredOption</code><span class="sig-paren">(</span><em>option</em>, <em>section</em>, <em>paths</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#MisdeclaredOption"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.MisdeclaredOption" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a option is misdeclared of a section from the configuration file.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoNetCDFAttribute">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoNetCDFAttribute</code><span class="sig-paren">(</span><em>attribute</em>, <em>path</em>, <em>variable=None</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoNetCDFAttribute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoNetCDFAttribute" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a NetCDF attribute is missing.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.NoNetCDFVariable">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">NoNetCDFVariable</code><span class="sig-paren">(</span><em>variable</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#NoNetCDFVariable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.NoNetCDFVariable" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a NetCDF variable is missing.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.InvalidMapHeader">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">InvalidMapHeader</code><span class="sig-paren">(</span><em>pattern</em>, <em>header</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#InvalidMapHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.InvalidMapHeader" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when invalid map header.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.InvalidMapEntry">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">InvalidMapEntry</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#InvalidMapEntry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.InvalidMapEntry" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when invalid map header.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.DuplicatedMapEntry">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">DuplicatedMapEntry</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#DuplicatedMapEntry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.DuplicatedMapEntry" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when invalid map header.</p>
</dd></dl>

<dl class="exception">
<dt id="esgprep.utils.exceptions.DirectoryNotMatch">
<em class="property">exception </em><code class="descclassname">esgprep.utils.exceptions.</code><code class="descname">DirectoryNotMatch</code><span class="sig-paren">(</span><em>path</em>, <em>directory_format</em>, <em>section</em>, <em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="modules/esgprep/utils/exceptions.html#DirectoryNotMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#esgprep.utils.exceptions.DirectoryNotMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a directory does not math the regex format.</p>
</dd></dl>

<p><em>Module author: Levavasseur Guillaume (CNRS/IPSL) &lt;<a class="reference external" href="mailto:glipsl&#37;&#52;&#48;ipsl&#46;jussieu&#46;fr">glipsl<span>&#64;</span>ipsl<span>&#46;</span>jussieu<span>&#46;</span>fr</a>&gt;</em></p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="log.html" class="btn btn-neutral" title="Changelog" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Levavasseur, G..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.5.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>